q()
31*20*52
40*20*52
2650*3*4
31*15*52
40*15*52
44*15*52
42*15*52
41*15*52
40*15*52
35*20*52
35*15*52
31*40*52
(44-31)/44
347*3
165-151
15
5+13+8+6+17+12
8.7e-5
8.7e-5 * 1000
8.7e-5 * 1000 * 40
100/30/1000
8.7e-5
3.3e-2
3.3e-3
100/30
100/30/1000
3.44*30
6.86*30
630/28
28*117
630+2940
28*117+2940
6216-3570
q()
2772
95*24
95*48
95*60
95*50+2772*2
95*48+2772*2
95*30+2772
95*40+2772
95*35+2772
95*30+2772
356/5000*60000
262+257+228+193+188+170+151+141
110/9.8
q()
26.72/200
getwd()
install.packages('introgress')
library(introgress)
install.packages(mvtnorm)
install.packages('mvtnorm')
library(introgress)
seq_len(8)
?seq_len
seq_len(f=2,t=4,l=8)
seq_len(f=2,t=4)
seq_len(7)
seq_len(11)
seq_len(pi)
seq_along(letters)
data.frame(letters=letters)
seq_along(data.frame(letters=letters))
seq_along(data.frame(letters=letters)[,1])
?seq_along
for (i in seq_along(letters)) {print(letters[i])}
for (i in seq_along(letters)) {cat(letters[i])}
for (i in seq_along(letters)) {print(letters[i])}
?cat
for (i in seq_along(letters)) {cat(letters[i],"\n")}
for (i in seq_along(letters)) {print(letters[i])}
q()
2800+108*30
2800+108*35
?mapply
mapply(rep, 1:4, 4:1)
mapply(function(x, y) seq_len(x) + y,
c(a =  1, b = 2, c = 3),  # names from first
c(A = 10, B = 0, C = -10))
seq_along(2:5)
?seq_along
q()
?ddply
??ddply
?aggregate
library(plyr)
??ddply
?selet
?select
library(plyr)
library(dplyr)
?select
?arrange
q()
install.packages(c("foreign", "survival"))
library(plyr)
?install.packages
install.packages(c('plyr','dplyr','magrittr'))
library(plyr)
library(dplyr)
install.packages(c('raster','rgdal','sp','raster','rgeos'))
install.packages('hzar')
install.packages('adegenet')
library(ape)(
)
library(ape)
license()
RShowDoc("COPYING")
?read.nexus.data
q()
l <- 30   #length
v <- 1    #passwords
x1 <- TRUE #Capital letters
x2 <- TRUE #Numbers
x3 <- TRUE #Symbols
c("`","~","!","@","#","$","%","^","&","*","(",")","_","-","+","=","{","}","[","]","|",
":",";","'","<",">",",",".","?","/"," ") -> s
set <- letters
if (x1) {c(set,LETTERS) -> set}
if (x2) {c(set,0:9) -> set}
if (x3) {c(set,s) -> set}
#c(letters,LETTERS,0:9,s) -> set
length(set) -> n
c(length(letters),length(LETTERS),length(0:9),length(s)) -> m
floor(m/length(set)*l) -> m  # Get minimums for ea. character type
character(0) -> d
for (z in 1:v){
character(0) -> p
while (sum(p %in% letters)<m[1] | sum(p %in% LETTERS)<m[2] | sum(p %in% 0:9)<m[3] | sum(p %in% s)<m[4])
{
character(0) -> p
for (i in 1:l){
c(p,set[sample(1:n,1)]) -> p
}
#print(paste(p,sep="",collapse="")) # to show options not meeting m criteria
}
paste(p,sep="",collapse="")-> d[z]
}
as.data.frame(d) -> d
"password" -> names(d)
d
rm(d)
q()
getwd()
"JQ900644" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900645" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900646" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900726" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900647" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900648" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900649" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900650" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900727" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
?write.nexus.file
filenames <- list.files("/Users/dave/Desktop/genbank haring")
filenames
?read
?readLines
readLines("/Users/dave/Desktop/genbank haring/JQ900644.txt")
path <- "/Users/dave/Desktop/genbank haring"
filenames <- list.files(path)
filenames
?sub
gnames <- sub(".txt",filenames)
gnames <- sub("\.txt",filenames)
filenames <- list.files(path)
gnames <- sub(".txt",filenames)
gnames <- sub(".txt","",filenames)
gnames
path <- "/Users/dave/Desktop/genbank haring"
filenames <- list.files(path)
gnames <- sub(".txt","",filenames)
lapply(gnames,function(x) NULL)
?lapply
sapply(gnames,function(x) NULL,USE.NAMES=T)
path <- "/Users/dave/Desktop/genbank haring"
filenames <- list.files(path)
gnames <- sub(".txt","",filenames)
sapply(gnames,function(x) NULL,USE.NAMES=T)
mylist <- sapply(gnames,function(x) NULL,USE.NAMES=T)
filenames
paste0(path,filenames)
path <- "/Users/dave/Desktop/genbank haring/"
filenames <- list.files(path)
gnames <- sub(".txt","",filenames)
mylist <- sapply(gnames,function(x) NULL,USE.NAMES=T)
paste0(path,filenames)
mylist <- lapply(paste0(path,filenames),function(x){
readLines(x))
mylist <- lapply(paste0(path,filenames),function(x){
readLines(x)})
mylist
gnames -> names(mylist)
mylist
gnames -> names(mylist)
write.nexus.data(mylist,"haring.nex",interleaved=F)
getwd()
?write.FASTA
write.FASTA(mylist,"haring.fasta")
mylist
write.FASTA(mylist,"haring.fasta")
write.dna(mylist,"haring.fasta")
write.dna(mylist,"haring.fasta",format='fasta')
write.dna(mylist,"haring.fasta",format='fasta',nbcol=-1)
write.dna(mylist,"haring.fasta",format='fasta',nbcol=-1,colw=10000)
?as.alignment
mylist
lapply(mylist,nchar)
lapply(mylist,nchar) %>% unname
lapply(mylist,nchar) %>% unlist
library(magrittr)
lapply(mylist,nchar) %>% unlist
?dist.dna
?read.nexus
as.DNAbin(read.nexus.data("/Users/dave/Desktop/haring.nex"))
?BIONJ
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
plot
?bionj
"EU070774" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
read.nexus.data("/Users/dave/Desktop/haring.nex")
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
plot
?root
read.nexus.data("/Users/dave/Desktop/haring.nex")
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root('EU070774') %>%
plot
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root('EU070774')
?root
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root(outgroup='EU070774')
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
names
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna
?root
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root(outgroup="EU070774",resolve.root=T) %>%
plot
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root(outgroup="EU070774",resolve.root=T)
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root(outgroup="EU070774")
?root
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root(outgroup="EU070774",resolve.root=T) %>%
plot
getwd()
quit()
q()
2018-160
q()
95+163
?binomial.test
?binomial
?exact.test
?exact
?binom.test
binom.test(x=3,n=11,p=(17/23),alternative="two.sided")
binom.test(x=3,n=11,p=(17/23),alternative="two.sided")
binom.test(x=5,n=8,p=(8/9),alternative="two.sided")
binom.test(x=1,n=3,p=(8/9),alternative="two.sided")
binom.test(x=1,n=4,p=(8/9),alternative="two.sided")
3690+3500+892+363+133+221
360+387+350+260+140
q()
1*10/100000
190/99990*99990/100000
1e-4*/.Last.value
1e-4/.0019
1e-4+190/99990*99990/100000
1e-4/.002
.0001/(.0001*.0002)
.0001/(.0001*.002)
1/10000/(1/10000+1.9e-3)
10/100000/(.5*10/100000+.5*190/99990)
.00005/(.00005+.5*.002)
q()
3*.9
3*.8
20/50*3
30/50*3
q()
45/50*3
q()
d <- structure(list(Angle = c(0, 10, 20, 30, 40, 50, 60, 70, 80, 90,
100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220,
230, 240, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 250
), Frequency = c(0, 0, 0.001, 2, 4, 18.03, 11, 12, 5, 7, 10,
13, 2, 0.003, 0.01, 0, 1, 0.05, 2, 3, 3.7, 6, 0, 0, 0, 0, 0.2,
0.006, 0, 0, 0, 0, 0, 0, 0, 0)), .Names = c("Angle", "Frequency"
), row.names = c(NA, 36L), class = "data.frame")
str(d)
?structure
d
library(ggplot2)
ggplot(d, aes(x = Angle, y = Frequency)) +
coord_polar(theta = "x", start = -pi/45) +
geom_bar(stat = "identity") +
scale_x_continuous(breaks = seq(0, 360, 60))
?coord_polar
?geom_bar
?scale_x_continuous
q()
?scan
q()
q()
setwd('/Users/dave/crows/ms/Scripts/mtDNA/map_v2')
getwd()
#library(OpenStreetMap)
library(raster)
#library(mapplots)
library(rgdal)
#library(plotrix)
library(maps)
library(sp)
library(raster)
library(RColorBrewer)
library(rgeos)
## CUSTOM FUNCTION DEPENDENCIES for Pies:
source("add.pie.ask.asp.R")
source("draw.circle.ask.asp.R")
## Transparent color function
t_col <- function(color, percent = 50, name = NULL) {
rgb.val <- col2rgb(color)
t.col <- rgb(rgb.val[1], rgb.val[2], rgb.val[3],
max = 255,
alpha = (100-percent)*255/100,
names = name)
invisible(t.col)
}
t_percent <- 0 # transparency
pie.size <- .03
pop_haps <- read.csv("pop_haps.csv",stringsAsFactors=F)
## Get Shapefiles
amcr <- readOGR("rangemaps/amcr_only",layer="amcr_only")
nocr <- readOGR("rangemaps/nocr_only_final",layer="nocr_only_final")
overlap_zone <- readOGR("rangemaps/overlap_zone_final",layer="overlap_zone_final")
## Define UTM projection
my.projection <- "+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"
## Manual encode UTM-zone 10 boundaries for 2/3 aspect ratio Western US map
x0 <- -446329
x1 <- 1394510
y0 <- 4010916
y1 <- 6772176
## Crop to desired extent
amcr <- crop(amcr, extent(x0, x1, y0, y1))
nocr <- crop(nocr, extent(x0, x1, y0, y1))
overlap_zone <- crop(overlap_zone, extent(x0, x1, y0, y1))
can <- crop(can, extent(x0, x1, y0, y1))
usa <- crop(usa, extent(x0, x1, y0, y1))
'#FDC086' -> orange
'#BEAED4' -> purple
'#7FC97F' -> green
'#CC3311' -> red
'#0077BB' -> blue
#png("trial.png",w=13/3,h=6.5,units="in",res=1000)
pdf("crow_map_final.pdf",13/3,6.5)
par(mar=rep(0,4))
plot(1, type="n", xlab="", ylab="",xaxs = "i", yaxs = "i",xlim=c(x0, x1), ylim=c(y0, y1))
plot(nocr,add=T,lty=0,col=t_col(green,t_percent))
plot(amcr,add=T,lty=0,col=t_col(orange,t_percent))
plot(overlap_zone,add=T,lty=0,col=t_col(purple,t_percent))
plot(can,add=T)
plot(usa,add=T)
#dev.off()
## User specified values
pnw.final.w.in <- 13/3  ## Hard-coded for now
pnw.xmin <- x0  ## Lazy redefinition of variable names for old code
pnw.xmax <- x1
pnw.ymin <- y0
pnw.ymax <- y1
## Autocalc'd and some console outputs
x1-x0 -> pnw.bbox.width
y1-y0 -> pnw.bbox.height
pnw.raw.w.in <- pnw.final.w.in/(pnw.xmax-pnw.xmin)*pnw.bbox.width
pnw.raw.h.in <- pnw.raw.w.in*(pnw.bbox.height/pnw.bbox.width)
#left crop inches
#pnw.raw.w.in*(pnw.xmin-pnw$bbox$p1[1])/pnw.bbox.width
#right crop inches
#pnw.raw.w.in*(pnw$bbox$p2[1]-pnw.xmax)/pnw.bbox.width
#top crop inches
#pnw.raw.h.in*(pnw$bbox$p1[2]-pnw.ymax)/pnw.bbox.height
#bottom crop inches
#pnw.raw.h.in*(pnw.ymin-pnw$bbox$p2[2])/pnw.bbox.height
#Final width PNW
#pnw.final.w.in
#Final height PNW
#pnw.final.w.in/(pnw.xmax-pnw.xmin)*(pnw.ymax-pnw.ymin)
#pdf("pnw.pdf",pnw.raw.w.in,pnw.raw.h.in)
#plot(pnw)
#plot(amcrnocr,border=NA,col=rgb(0,0,0,alpha=0.3),add=T)
#abline(v=pnw.xmin)
#abline(v=pnw.xmax)
#abline(h=pnw.ymin)
#abline(h=pnw.ymax)
##Inset pies
#subset(pop_haps,pop_haps$plot=='inset') -> a
pop_haps -> a
SpatialPoints(a[,c('x','y')],CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")) -> coords
spTransform(coords,my.projection) -> coords
for (i in 1:nrow(a)){
if (min(c(a[i,'A'],a[i,'N'])) > 0){
add.pie.ask.asp(asp=1,z=c(a[i,'A'],a[i,'N']),x=coords@coords[i,'x'],y=coords@coords[i,'y'],radius=pie.size/pnw.final.w.in*(pnw.xmax-pnw.xmin)*sqrt(a[i,'A']+a[i,'N']),col=c(red,blue),init.angle=a[i,'ia'],clockwise=a[i,'cw'],labels="")
}
else {
draw.circle.ask.asp(asp=1,x=coords@coords[i,'x'],y=coords@coords[i,'y'],radius=pie.size/pnw.final.w.in*(pnw.xmax-pnw.xmin)*sqrt(a[i,'A']+a[i,'N']),border='black',col=ifelse(a[i,'A']==0,blue,red))
}
}
dev.off()
q()
