721620/599188440
.Last.value*100
721620/599188440
1/.Last.value
721620*.01
q()
31*20*52
40*20*52
2650*3*4
31*15*52
40*15*52
44*15*52
42*15*52
41*15*52
40*15*52
35*20*52
35*15*52
31*40*52
(44-31)/44
347*3
165-151
15
5+13+8+6+17+12
8.7e-5
8.7e-5 * 1000
8.7e-5 * 1000 * 40
100/30/1000
8.7e-5
3.3e-2
3.3e-3
100/30
100/30/1000
3.44*30
6.86*30
630/28
28*117
630+2940
28*117+2940
6216-3570
q()
2772
95*24
95*48
95*60
95*50+2772*2
95*48+2772*2
95*30+2772
95*40+2772
95*35+2772
95*30+2772
356/5000*60000
262+257+228+193+188+170+151+141
110/9.8
q()
26.72/200
getwd()
install.packages('introgress')
library(introgress)
install.packages(mvtnorm)
install.packages('mvtnorm')
library(introgress)
seq_len(8)
?seq_len
seq_len(f=2,t=4,l=8)
seq_len(f=2,t=4)
seq_len(7)
seq_len(11)
seq_len(pi)
seq_along(letters)
data.frame(letters=letters)
seq_along(data.frame(letters=letters))
seq_along(data.frame(letters=letters)[,1])
?seq_along
for (i in seq_along(letters)) {print(letters[i])}
for (i in seq_along(letters)) {cat(letters[i])}
for (i in seq_along(letters)) {print(letters[i])}
?cat
for (i in seq_along(letters)) {cat(letters[i],"\n")}
for (i in seq_along(letters)) {print(letters[i])}
q()
2800+108*30
2800+108*35
?mapply
mapply(rep, 1:4, 4:1)
mapply(function(x, y) seq_len(x) + y,
c(a =  1, b = 2, c = 3),  # names from first
c(A = 10, B = 0, C = -10))
seq_along(2:5)
?seq_along
q()
?ddply
??ddply
?aggregate
library(plyr)
??ddply
?selet
?select
library(plyr)
library(dplyr)
?select
?arrange
q()
install.packages(c("foreign", "survival"))
library(plyr)
?install.packages
install.packages(c('plyr','dplyr','magrittr'))
library(plyr)
library(dplyr)
install.packages(c('raster','rgdal','sp','raster','rgeos'))
install.packages('hzar')
install.packages('adegenet')
library(ape)(
)
library(ape)
license()
RShowDoc("COPYING")
?read.nexus.data
q()
l <- 30   #length
v <- 1    #passwords
x1 <- TRUE #Capital letters
x2 <- TRUE #Numbers
x3 <- TRUE #Symbols
c("`","~","!","@","#","$","%","^","&","*","(",")","_","-","+","=","{","}","[","]","|",
":",";","'","<",">",",",".","?","/"," ") -> s
set <- letters
if (x1) {c(set,LETTERS) -> set}
if (x2) {c(set,0:9) -> set}
if (x3) {c(set,s) -> set}
#c(letters,LETTERS,0:9,s) -> set
length(set) -> n
c(length(letters),length(LETTERS),length(0:9),length(s)) -> m
floor(m/length(set)*l) -> m  # Get minimums for ea. character type
character(0) -> d
for (z in 1:v){
character(0) -> p
while (sum(p %in% letters)<m[1] | sum(p %in% LETTERS)<m[2] | sum(p %in% 0:9)<m[3] | sum(p %in% s)<m[4])
{
character(0) -> p
for (i in 1:l){
c(p,set[sample(1:n,1)]) -> p
}
#print(paste(p,sep="",collapse="")) # to show options not meeting m criteria
}
paste(p,sep="",collapse="")-> d[z]
}
as.data.frame(d) -> d
"password" -> names(d)
d
rm(d)
q()
getwd()
"JQ900644" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900645" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900646" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900726" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900647" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900648" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900649" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900650" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
"JQ900727" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
## Added change for git demog
?write.nexus.file
filenames <- list.files("/Users/dave/Desktop/genbank haring")
filenames
?read
?readLines
readLines("/Users/dave/Desktop/genbank haring/JQ900644.txt")
path <- "/Users/dave/Desktop/genbank haring"
filenames <- list.files(path)
filenames
?sub
gnames <- sub(".txt",filenames)
gnames <- sub("\.txt",filenames)
filenames <- list.files(path)
gnames <- sub(".txt",filenames)
gnames <- sub(".txt","",filenames)
gnames
path <- "/Users/dave/Desktop/genbank haring"
filenames <- list.files(path)
gnames <- sub(".txt","",filenames)
lapply(gnames,function(x) NULL)
?lapply
sapply(gnames,function(x) NULL,USE.NAMES=T)
path <- "/Users/dave/Desktop/genbank haring"
filenames <- list.files(path)
gnames <- sub(".txt","",filenames)
sapply(gnames,function(x) NULL,USE.NAMES=T)
mylist <- sapply(gnames,function(x) NULL,USE.NAMES=T)
filenames
paste0(path,filenames)
path <- "/Users/dave/Desktop/genbank haring/"
filenames <- list.files(path)
gnames <- sub(".txt","",filenames)
mylist <- sapply(gnames,function(x) NULL,USE.NAMES=T)
paste0(path,filenames)
mylist <- lapply(paste0(path,filenames),function(x){
readLines(x))
mylist <- lapply(paste0(path,filenames),function(x){
readLines(x)})
mylist
gnames -> names(mylist)
mylist
gnames -> names(mylist)
write.nexus.data(mylist,"haring.nex",interleaved=F)
getwd()
?write.FASTA
write.FASTA(mylist,"haring.fasta")
mylist
write.FASTA(mylist,"haring.fasta")
write.dna(mylist,"haring.fasta")
write.dna(mylist,"haring.fasta",format='fasta')
write.dna(mylist,"haring.fasta",format='fasta',nbcol=-1)
write.dna(mylist,"haring.fasta",format='fasta',nbcol=-1,colw=10000)
?as.alignment
mylist
lapply(mylist,nchar)
lapply(mylist,nchar) %>% unname
lapply(mylist,nchar) %>% unlist
library(magrittr)
lapply(mylist,nchar) %>% unlist
?dist.dna
?read.nexus
as.DNAbin(read.nexus.data("/Users/dave/Desktop/haring.nex"))
?BIONJ
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
plot
?bionj
"EU070774" -> gb   # Input accession number
library(ape)
read.GenBank(gb,as.character=T) -> a
vapply(unlist(a),toupper,"A",USE.NAMES=F) -> a
paste(gb,".txt",sep="") -> f
cat(a,file=f,sep="")
read.nexus.data("/Users/dave/Desktop/haring.nex")
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
plot
?root
read.nexus.data("/Users/dave/Desktop/haring.nex")
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root('EU070774') %>%
plot
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root('EU070774')
?root
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root(outgroup='EU070774')
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
names
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna
?root
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root(outgroup="EU070774",resolve.root=T) %>%
plot
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root(outgroup="EU070774",resolve.root=T)
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root(outgroup="EU070774")
?root
read.nexus.data("/Users/dave/Desktop/haring.nex") %>%
as.DNAbin %>%
dist.dna %>%
bionj %>%
root(outgroup="EU070774",resolve.root=T) %>%
plot
getwd()
quit()
q()
2018-160
q()
95+163
?binomial.test
?binomial
?exact.test
?exact
?binom.test
binom.test(x=3,n=11,p=(17/23),alternative="two.sided")
binom.test(x=3,n=11,p=(17/23),alternative="two.sided")
binom.test(x=5,n=8,p=(8/9),alternative="two.sided")
binom.test(x=1,n=3,p=(8/9),alternative="two.sided")
binom.test(x=1,n=4,p=(8/9),alternative="two.sided")
3690+3500+892+363+133+221
360+387+350+260+140
q()
1*10/100000
190/99990*99990/100000
1e-4*/.Last.value
1e-4/.0019
1e-4+190/99990*99990/100000
1e-4/.002
.0001/(.0001*.0002)
.0001/(.0001*.002)
1/10000/(1/10000+1.9e-3)
10/100000/(.5*10/100000+.5*190/99990)
.00005/(.00005+.5*.002)
q()
3*.9
3*.8
20/50*3
30/50*3
q()
45/50*3
q()
d <- structure(list(Angle = c(0, 10, 20, 30, 40, 50, 60, 70, 80, 90,
100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220,
230, 240, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 250
), Frequency = c(0, 0, 0.001, 2, 4, 18.03, 11, 12, 5, 7, 10,
13, 2, 0.003, 0.01, 0, 1, 0.05, 2, 3, 3.7, 6, 0, 0, 0, 0, 0.2,
0.006, 0, 0, 0, 0, 0, 0, 0, 0)), .Names = c("Angle", "Frequency"
), row.names = c(NA, 36L), class = "data.frame")
str(d)
?structure
d
library(ggplot2)
ggplot(d, aes(x = Angle, y = Frequency)) +
coord_polar(theta = "x", start = -pi/45) +
geom_bar(stat = "identity") +
scale_x_continuous(breaks = seq(0, 360, 60))
?coord_polar
?geom_bar
?scale_x_continuous
q()
?scan
q()
q()
setwd('/Users/dave/crows/ms/Scripts/mtDNA')
ls
list.files()
library(ape)
#read.nexus.data("allcrowsND2.nex") -> nexus
read.nexus.data("allcrowsND2_260.nex") -> nexus
length(nexus)
names(nexus) -> nexus.labels
as.DNAbin(nexus) -> alignment
dist.dna(alignment) -> distances
bionj(distances) -> nj
str(nj)
root(nj,"Corvus_corone") -> rootednj
makeNodeLabel(rootednj, method = "number", prefix = "N") -> rootednj
plot.phylo(rootednj,show.node.label=TRUE)
pdf("Rplot.pdf",20,100)
plot.phylo(rootednj,show.node.label=TRUE)
dev.off()
extract.clade(rootednj,"N127")$tip.label -> nw #was 89, now 95 with 8 more full ND2
extract.clade(rootednj,"N123")$tip.label -> am #was 162, now 164 with 8 more full ND2
nw
am
data.frame(tip.label=c(nw,am),haplotype=c(rep("N",length(nw)),rep("A",length(am))),stringsAsFactors=FALSE) -> info
info
# Plot with node labels
pdf("nj_tree.pdf",20,100)
plot.phylo(rootednj,show.node.label=TRUE)
dev.off()
library(ape)
library(magrittr)
list.files()
nex <- read.nexus.data("allcrowsND2_260.nex")
length(nex) # 252 NOW 260
length(nex) # 260
nex$Corvus_corone <- NULL      ## Remove Outgroup
nex$gws4003_Pierce_Co <- NULL  ## Remove Partial sequence
length(nex) # 250 NOW 258
haps <- read.csv("popart_haplotype259.csv",header=T,stringsAsFactors=F)
haps <- haps[which(haps$X!="Corvus_corone"),]
haps[,"A"] <- as.logical(haps[,"A"])
haps[,"N"] <- as.logical(haps[,"N"])
haps
all(names(nex) %in% haps$X)
all(haps$X %in% names(nex))
## Fix the order
haps[match(names(nex), haps$X),] -> haps
## Check the order
all(haps$X == names(nex))   ## Yes. length=258
## Raw, pairwise, between American and Northwestern
dm <- dist.dna(as.DNAbin(nex),model="raw",as.matrix=T)
dm <- dm[haps[haps$A,"X"],haps[haps$N,"X"]]
nrow(dm) #A
ncol(dm) #N
mean(dm)
range(dm)
median(dm*1041)
range(dm*1041)
mean(dm)/.029*1e6 #estimate
mean(dm)/.024*1e6 #lower HPD
mean(dm)/.033*1e6 #high  HPD
haps[which(haps$A==TRUE),'X'] -> amcr.names
haps[which(haps$N==TRUE),'X'] -> nocr.names
nex[amcr.names] -> amcr.nex
nex[nocr.names] -> nocr.nex
sapply(1:length(nex[[1]]),function(x){
sapply(amcr.nex,function(i){i[[x]]}) -> amcr.nuc
sapply(nocr.nex,function(i){i[[x]]}) -> nocr.nuc
if (  (length(unique(amcr.nuc))==1) & (length(unique(nocr.nuc))==1) & (!identical(unique(amcr.nuc),unique(nocr.nuc))) ) return(TRUE) else return(FALSE)
}) %>% unlist %>% which
## Chi-squared tests for some populations
read.csv('pop_haps.csv',stringsAsFactors=F,header=T) -> ph
## Chi-squared tests for some populations
read.csv('pop_haps.csv',stringsAsFactors=F,header=T) -> ph
ph
ph[ph$pop %in% c("nvi","vic","cbc","yvr"),]
ph[ph$pop %in% c("nvi","cbc"),c("A","N")]
ph[ph$pop %in% c("vic","yvr"),c("A","N")]
ph[ph$pop %in% c("nvi","vic","cbc","yvr"),]
ph[ph$pop %in% c("nvi","cbc"),c("A","N")] %>% chisq.test(correct=F)
ph[ph$pop %in% c("nvi","cbc"),c("A","N")] %>% chisq.test(correct=F)
ph[ph$pop %in% c("vic","yvr"),c("A","N")] %>% chisq.test(correct=F)
?chisq.test
ph[ph$pop %in% c("nvi","cbc"),c("A","N")] %>% chisq.test(simulate.p.value = T)
ph[ph$pop %in% c("vic","yvr"),c("A","N")] %>% chisq.test(simulate.p.value = T)
ph[ph$pop %in% c("nvi","vic","cbc","yvr"),]
ph[ph$pop %in% c("nvi","cbc"),c("A","N")]
ph[ph$pop %in% c("vic","yvr"),c("A","N")]
ph[ph$pop %in% c("nvi","vic","cbc","yvr"),]
ph[ph$pop %in% c("nvi","cbc"),c("A","N")] %>% chisq.test(simulate.p.value = T)
ph[ph$pop %in% c("nvi","vic","cbc","yvr"),]
ph[ph$pop %in% c("nvi","cbc"),c("A","N")]
ph[ph$pop %in% c("nvi","cbc"),c("A","N")] %>% chisq.test(simulate.p.value = T)
ph[ph$pop %in% c("nvi","vic","cbc","yvr"),]
matrix(c(25,9,9,26),ncol=2,byrow=T)
ph[ph$pop %in% c("nvi","cbc"),c("A","N")]
25/(25+9)
9/(26+9)
matrix(c(25,9,9,26),ncol=2,byrow=T) %>% chisq.test(simulate.p.value=T)
q()
